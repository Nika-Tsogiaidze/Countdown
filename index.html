<!DOCTYPE html>
<html>
<head>
	<title>Countdown timer on d3.js</title>
	<style>
		svg {
	        	transform: rotate(-90deg);
			background: #f1d0d0;
		}
	</style>
	<script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
    <svg width="200" height="200">
        <circle id="secondsCircle" cx="100" cy="100" r="94" fill="none" stroke="#f77a52" stroke-width="12" stroke-dasharray="600" stroke-dashoffset="0" />
        <circle id="minutesCircle" cx="100" cy="100" r="80" fill="none" stroke="#f77a52" stroke-width="12" stroke-dasharray="600" stroke-dashoffset="0" />
        <circle id="hoursCircle" cx="100" cy="100" r="66" fill="none" stroke="#f77a52" stroke-width="12" stroke-dasharray="600" stroke-dashoffset="0" />
    </svg>
<script>
	// Global Variables
  	var secondsCircumference = 2 * Math.PI * d3.select("#secondsCircle").attr("r");
	var secondsStepLength = secondsCircumference / 60;
  	var minutesCircumference = 2 * Math.PI * d3.select("#minutesCircle").attr("r");
	var minutesStepLength = minutesCircumference / 60;
  	var hoursCircumference = 2 * Math.PI * d3.select("#hoursCircle").attr("r");
	var hoursStepLength = hoursCircumference / 24;
	var second = 50, minute = 45, hour = 4;

	// Major, Caller Functions
	calculateAndSetStrokeValues(second, minute, hour);

	setInterval(function (){
		updateSeconds();
	}, 1000);

	// Helper, Called Functions
	function updateSeconds(){
		currentOffset =	d3.select("#secondsCircle").attr("stroke-dashoffset");
		if(parseFloat(currentOffset) + parseFloat(secondsCircumference) <= 0) { currentOffset = 0; minutePassed(); }
		d3.select("#secondsCircle").transition().duration(1000).attr("stroke-dashoffset", currentOffset - secondsStepLength);
	}

	function calculateAndSetStrokeValues(second, minute, hour){
		seconds = -Math.abs(second * secondsStepLength);
		minutes = -Math.abs(minute * minutesStepLength);
		hours = -Math.abs(hour * hoursStepLength);
		setStrokeDashoffsets(seconds, minutes, hours);
	}

	function setStrokeDashoffsets(seconds, minutes, hours){
		d3.select("#secondsCircle").attr("stroke-dashoffset", seconds);
		d3.select("#minutesCircle").transition().duration(2000).attr("stroke-dashoffset", minutes);
		d3.select("#hoursCircle").transition().duration(2000).attr("stroke-dashoffset", hours);
	}
</script>
</body>
</html>
